<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="og:title" content="La validation par Form Request dans Laravel 5.2" />
    <meta name="og:url" content="https://blog.otso.fr/2016-07-06-la-validation-par-form-request-dans-laravel-5.html" />
    <meta name="og:site_name" content="Blob Trotter" />

    
    <meta name="description" content="Les différentes manières de valider ses données et celle qui me parait la plus pratique à mettre en place" />
    <meta name="og:description" content="Les différentes manières de valider ses données et celle qui me parait la plus pratique à mettre en place" />
     
    <meta name="robots" content="index, follow" />
     
    <meta name="og:type" content="article" />
      
    <meta name="twitter:card" content="summary" />
     
    <meta name="twitter:site" content="@adriantombu" />
     
    <meta name="twitter:creator" content="@adriantombu" />
    

    <title>La validation par Form Request dans Laravel 5.2 - Blob Trotter</title>

    <link rel="icon" href="./favicon.png" />
    <link href="./style.css" rel="stylesheet" type="text/css" />
    <link href="./rss.xml" type="application/rss+xml" />
    <link rel="canonical" href="https://blog.otso.fr/2016-07-06-la-validation-par-form-request-dans-laravel-5.html" />
  </head>

  <body>
    <header>
      <nav>
        <a href="https://otso.fr">Accueil</a> &bull;
        <a href="https://otso.fr/index-en.html">In English</a> &bull; Blog
        &bull;
        <a href="https://otso.fr/conditions-generales-de-vente.html">CGV</a>
        &bull;
        <a href="https://otso.fr/mentions-legales.html">Mentions légales</a>
      </nav>
    </header>

    <article>
      <h1>La validation par Form Request dans Laravel 5.2</h1>

<p>Depuis que j’utilise Laravel, j’ai toujours cherché à avoir des Controllers les plus simples possibles. Et pourtant, des fois, c’est pas si simple que ça, surtout quand on commence à intégrer de la validation de formulaires.</p>

<h2>La validation dans le Controller</h2>

<p>En effet, je me suis vite retrouvé à remplir les fonctions de mes Controllers avec des <strong>dizaines de lignes de validation</strong> avant de pouvoir traiter mes données. Niveau simplicité on repassera !</p>

<script src="https://gist.github.com/adriantombu/f0297b837ef8fa8ba4eb143ffba0b305.js"></script>

<h2>La validation dans le Model</h2>

<p>Après quelques recherches sur les interouebs, j’ai testé la <strong>validation dans les Models</strong>. En gros on déplace la liste des règles de validation dans une variable (<em>ou une fonction, si on a besoin de quelque chose de plus complexe</em>) du Model, et on la récupère dans le Controlleur avant de valider. Ca donne un truc du style :</p>

<pre><code>$company = new Company();
$this-&gt;validate( $request, $company-&gt;rules );
</code></pre>

<p><strong>Moins de code, mais plus complexe</strong> (<em>j’ai vu des exemples bien plus capilotractés</em>), et j’estime que la validation n’a <strong>pas sa place dans les Models</strong> (<em>ouais j’suis comme ça, des fois j’ai un avis !</em>).</p>

<h2>La validation par Form Request</h2>

<p>En poursuivant ma quête de la validation (<em>presque</em>) parfaite, j’ai trouvé un article qui présentait <strong>la validation par Form Request</strong>. Et là, je suis instantanément tombé sous le charme. Comment ai-je fait pour ne pas voir cela dans la doc de Laravel 5, <a href="https://laravel.com/docs/5.2/validation#form-request-validation">au milieu de la page</a> monolithique sur la validation ? Personne ne le saura jamais.</p>

<p>Comment ça fonctionne ? C’est simple ! Un coup d’artisan pour créer une Class Form Request où l’on renseigne les conditions de validation, une injection de dépendance dans le Controller, et… c’est tout ! Plus aucune ligne de validation dans le Controller !</p>

<h2>La marche à suivre</h2>

<pre><code>php artisan make:request UserAddRequest
</code></pre>

<p>Cette commande va <strong>créer une Class</strong> UserAddRequest.php dans le répertoire <em>app/Http/Requests/</em>. Voici un exemple du contenu de ce fichier, repris d’un de mes projets :</p>

<script src="https://gist.github.com/adriantombu/cb78f51bd6e34751bedebd1105d7ecce.js"></script>

<p>Comme vous pouvez le constater, il y a également une fonction très pratique qui permet de <strong>personnaliser les messages d’erreurs</strong> renvoyés. Plus d’infos sur la fonction <em>authorize</em> dans la doc !</p>

<p>Il ne reste plus qu’à <strong>injecter cette Form Request dans votre fonction</strong>, et c’est fini, adieu la validation dans le Controller, puisque celle-ci a désormais lieu <strong>avant le chargement du Controller</strong>.</p>

<script src="https://gist.github.com/adriantombu/b38ce6bd02d4df39b4bc6b1a79a8127b.js"></script>

<h2>Conclusion</h2>

<p>Les Form Request sont clairement un <strong>outil très pratique de Laravel 5</strong>, simples à utiliser, et néanmoins très puissants en cas de validation plus poussée. N’hésitez donc pas à les utiliser dès aujourd’hui, votre code vous en sera reconnaissant !</p>

    </article>

    <footer>
      <nav>
        
        <p>
          <a href="2016-10-17-mon-interview-a-la-cantine-nwx.html"
            >&lt;&lt; Mon interview à la Cantine NWX</a
          >
        </p>
         
        <p>
          <a href="2015-12-23-pourquoi-je-ne-reponds-plus-au-telephone.html"
            >Pourquoi je ne réponds plus au téléphone &gt;&gt;</a
          >
        </p>
        
      </nav>
    </footer>
  </body>
</html>
